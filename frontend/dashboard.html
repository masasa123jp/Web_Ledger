<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>データマネジメントダッシュボード (多言語 & チャート全種)</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- CSS -->
  <link rel="stylesheet" href="/static/css/style.css">
  <link rel="stylesheet" href="/static/css/dashboard.css">
  <style>
    #selection-form {
      border: 1px dashed #aaa;
      padding: 10px;
      margin-bottom: 20px;
    }
    .section-title {
      font-weight: bold;
      margin-top: 1rem;
      margin-bottom: 0.5rem;
    }
  </style>
</head>
<body>
  <div id="app">
    <app-header
      :texts="headerTexts"
      @toggle-language="toggleLanguage"
      @logout-success="handleLogoutSuccess">
    </app-header>

    <div class="container-fluid py-3">
      <div class="row">
        <div class="col" id="dashboard-main">
          <main>
            <!-- 選択フォーム -->
            <section id="selection-form" class="mb-3">
              <form id="data-selection-form" class="form-inline">
                <!-- 台帳 -->
                <div class="section-title" id="title-ledger"></div>
                <select id="ledgerTypeSelect" class="form-control mb-2" style="min-width: 200px;">
                  <option value="">台帳を選択してください</option>
                </select>

                <!-- 項目複数選択 -->
                <div class="section-title" id="title-fields"></div>
                <select id="fieldsSelect" class="form-control" multiple size="6" style="min-width: 200px;"></select>

                <!-- チャートライブラリ＆タイプ -->
                <div class="section-title" id="title-chart-settings"></div>
                <div class="row">
                  <div class="col-md-6">
                    <!-- チャートライブラリ選択 -->
                    <div class="mb-2">
                      <label for="chartEngineSelect" id="label-engine"></label>
                      <select id="chartEngineSelect" class="form-control"></select>
                    </div>
                    <!-- チャートタイプ選択 -->
                    <div class="mb-2">
                      <label for="chartTypeSelect" id="label-chart-type"></label>
                      <select id="chartTypeSelect" class="form-control"></select>
                    </div>
                    <!-- 集計方法 -->
                    <div class="mb-2">
                      <label for="aggregatorSelect" id="label-aggregator"></label>
                      <select id="aggregatorSelect" class="form-control">
                        <option value="sum">合計 / Sum</option>
                        <option value="count">件数 / Count</option>
                        <option value="avg">平均 / Average</option>
                      </select>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <!-- 軸設定 -->
                    <div class="mb-2">
                      <label for="xFieldSelect" id="label-xaxis"></label>
                      <select id="xFieldSelect" class="form-control"></select>
                    </div>
                    <div class="mb-2">
                      <label for="subFieldSelect" id="label-subcat"></label>
                      <select id="subFieldSelect" class="form-control">
                        <option value="">(なし)</option>
                      </select>
                    </div>
                    <div class="mb-2">
                      <label for="valueFieldSelect" id="label-value"></label>
                      <select id="valueFieldSelect" class="form-control"></select>
                    </div>
                  </div>
                </div>

                <!-- 適用ボタン -->
                <button id="apply-selection" type="submit" class="btn btn-primary" style="min-width: 120px;">
                  適用 / Apply
                </button>
                <button id="export-excel" class="btn btn-primary">Excel出力</button>
                <button id="export-csv" class="btn btn-primary">CSV出力</button>
                <button id="export-pdf" class="btn btn-primary">PDF出力</button>
              </form>
            </section>
            <!-- チャート表示エリア -->
            <section id="dashboard-chart-container" class="mb-3">
              <div id="dashboard-chart" style="width: 100%; height: 0px;"></div>
            </section>
          </main>
        </div>
      </div>
    </div>
  </div>

  <!-- Core libs -->
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Global Scripts -->
  <script src="/static/js/common/global.js"></script>
  <script src="/static/js/common/texts.js"></script>
  <script src="/static/js/common/header.js"></script>

  <!-- ApexCharts -->
  <script src="https://cdn.jsdelivr.net/npm/apexcharts/dist/apexcharts.min.js"></script>
  <!-- Plotly -->
  <script src="https://cdn.jsdelivr.net/npm/plotly.js-dist@2.18.2/plotly.min.js"></script>


  <!-- Modules -->
  <script type="module" src="/static/js/modules/dataSync.js"></script>
  <script type="module" src="/static/js/modules/exportUtil.js"></script>
  <script type="module" src="/static/js/modules/dataDashboardManager.js"></script>
  <script type="module" src="/static/js/modules/dataDashboardApp.js"></script>
  <script type="module">
    import dataDashboardCharts from '/static/js/modules/dataDashboardCharts.js';
  </script>

</body>
</html>
